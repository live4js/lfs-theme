{% load i18n lfs_tags %}

{# Voucher #}

<div class="voucher">
<h2 class="padding-top-large">
    {% trans "Voucher code" %}
</h2>
<input data="{% url "lfs_check_voucher" %}"
       type="text"
       id="voucher"
       name="voucher"
       value="{{ voucher_number }}"
       size="30" />

{% if voucher_number and voucher_message %}
    <span class="voucher-message">
        {{ voucher_message }}
    </span>
{% endif %}
</div>

<h2>{% trans 'Your cart' %}</h2>
<table class="table table-bordered"> 
    <tr>
        <th colspan="2" class="col-md-5">
            {% trans 'Product' %}
        </th>
        <th class="left col-md-1">
            {% trans 'Amount' %}
        </th>
        <th class="number hidden-xs col-md-2">
            {% trans 'Net Price' %}
        </th>
        <th class="number col-md-2">
            {% trans 'VAT' %}
        </th>
        <th class="number col-md-2">
            {% trans 'Total' %}
        </th>
    </tr>
    {% for cart_item in cart_items %}
        <tr>
            <td class="image col-md-1">
                <a href="{{ cart_item.product.get_absolute_url }}">
                    <img src="{{ cart_item.product.get_image.image.url_60x60 }}"
                         alt="{{ cart_item.product.get_name }}"/>
                </a>
            </td>
            <td class="col-md-4">
                {{ cart_item.product.get_name }}
                {% for property in cart_item.product.get_variant_properties %}
                    <div>
                        {{ property.title }}: {{ property.value }} {{ property.unit|safe }}
                    </div>
                {% endfor %}

                {% for property in cart_item.product.get_displayed_properties %}
                    <div>
                        {{ property.title }}: {{ property.value }} {{ property.unit|safe }}
                    </div>
                {% endfor %}

                {% if cart_item.product.is_configurable_product %}
                    {% for property in cart_item.obj.get_properties %}
                        <div>
                            {{ property.title }}: {{ property.value }} {{ property.unit|safe }}
                            {% if property.obj.is_select_field and property.display_price %}
                                ({{ property.price|currency:request}})
                            {% endif %}
                        </div>
                    {% endfor %}
                {% endif %}

            </td>
            <td class="number">
                <div>
		{{ cart_item.quantity }}
		</div>

                <div> 
		{{ cart_item.product.unit }}

                {% if cart_item.product.active_packing_unit %}
                    <span class="packing-unit">
                        ({{ cart_item.obj|packages }} {{ cart_item.product.packing_unit_unit }})
                    </span>
                {% endif %}
		</div>
            </td>
            <td class="number hidden-xs">
                {{ cart_item.product_price_net|currency:request}}
            </td>
            <td class="number">
                {{ cart_item.product_tax|currency:request}}
            </td>
            <td class="number">
                {{ cart_item.product_price_gross|currency:request}}
            </td>
        </tr>
    {% endfor %}

    {% for discount in discounts %}
        <tr id="discounts-display">
            <td></td>
            <td class="left">
                {{ discount.name }}
            </td>
            <td class="number">
                1
            </td>
            <td></td>
            <td class="number">
                - {{ discount.price_net|currency:request}}
            </td>
            <td class="number">
                {% if discount.tax %}
                    (- {{ discount.tax|currency:request}})
                {% endif %}
            </td>
            <td class="number">
                - {{ discount.price_gross|currency:request}}
            </td>
        </tr>
    {% endfor %}

    {% if display_voucher %}
        <tr id="voucher-display">
            <td></td>
            <td class="left">
                {% trans "Voucher" %}
            </td>
            <td class="number">
                1
            </td>
            <td></td>
            <td class="number hidden-xs">
                - {{ voucher_value|currency:request}}
            </td>
            <td class="number">
                ({{ voucher_tax|currency:request}})
            </td>
            <td class="number">
                - {{ voucher_value|currency:request}}
            </td>
        </tr>
    {% endif %}
</table>

<div id="total" class="col-md-12">

	<div id="shipping-price">
		<div>{% trans 'Shipping' %} ({{ selected_shipping_method.name }}):</div>
		<div class="price">{{ shipping_price|currency:request}}</div>
	</div>

	<div id="payment-price">
		<div>{% trans 'Payment' %} ({{ selected_payment_method.name }}):</div>
		<div class="price">{{ payment_price|currency:request}}</div>
	</div>

	<div id="tax-price">
		<div>{% trans 'Inclusive VAT' %}:</div>
		<div class="price">{{ cart_tax|currency:request}}</div>
	</div>

	<div id="total-price">
		<div class="total-name">{% trans 'Total' %}:</div>
		<div class="price total-name">{{ cart_price|currency:request}}</div>
	</div>
</div>
